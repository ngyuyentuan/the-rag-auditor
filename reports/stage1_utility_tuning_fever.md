# Stage1 Utility Tuning (fever)

Config

- in_path: `/mnt/c/Users/nguye/Downloads/My projject/the-rag-auditor/data/calibration/fever_stage1_dev_train.parquet`
- n_raw: `5715`
- n_used: `1000`
- seed: `14`
- logit_col: `logit_platt`
- y_col: `y`
- tau_source: `joint_grid`
- tau_grid_min: `0.2`
- tau_grid_max: `2.0`
- tau_grid_steps: `60`
- max_fp_accept_rate: `0.05`
- max_fn_reject_rate: `0.05`
- max_fp_decided_upper95: `0.1`
- max_fn_decided_upper95: `0.1`
- lambda_fp: `10.0`
- lambda_fn: `10.0`
- lambda_unc: `1.0`
- constraint_ci: `wilson`
- min_coverage: `0.0`
- constraint_scope: `both`
- enforce_decided_ci: `False`

Baseline thresholds

- tau: `0.9957177012600404`
- t_lower: `0.0721672686678491`
- t_upper: `1.0`

| metric | value |
|---|---|
| accept_rate | 0.0000 |
| reject_rate | 0.1080 |
| uncertain_rate | 0.8920 |
| fp_accept_rate | 0.0000 |
| fn_reject_rate | 0.0010 |
| ok_rate | 0.9990 |
| coverage | 0.1080 |
| accuracy_on_decided | 0.9907 |

- feasible_configs: `17535`

Top configs by utility

| tau | t_lower | t_upper | accept_rate | reject_rate | uncertain_rate | fp_accept_rate | fn_reject_rate | fp_decided | fn_decided | ok_rate | coverage | accuracy_on_decided | utility | label |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 0.8712 | 0.1342 | 0.1946 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.2114 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.2281 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.2449 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.2617 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.2785 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.2953 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.3120 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.3288 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.3456 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.3624 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.3792 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.3959 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.4127 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.4295 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.4463 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.4631 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.4798 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.4966 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |
| 0.8712 | 0.1342 | 0.5134 | 0.0000 | 0.9410 | 0.0590 | 0.0000 | 0.0830 | 0.0000 | 0.0882 | 0.9170 | 0.9410 | 0.9118 | 0.0520 | grid |

Pareto summary

| tau | t_lower | t_upper | fp_accept_rate | fn_reject_rate | uncertain_rate | ok_rate | utility |
|---|---|---|---|---|---|---|---|
| 0.6271 | 0.0336 | 0.1275 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.1442 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.1610 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.1778 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.1946 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.2114 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.2281 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.2449 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.2617 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.2785 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.2953 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.3120 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.3288 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.3456 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.3624 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.3792 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.3959 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.4127 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.4295 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |
| 0.6271 | 0.0336 | 0.4463 | 0.0000 | 0.0360 | 0.4800 | 0.9640 | -0.3200 |

Selected config

- tau: `0.6271186440677967`
- t_lower: `0.0335593220338983`
- t_upper: `0.12745762711864406`
- utility: `-0.31999999999999995`
- fp_accept_rate: `0.0`
- fn_reject_rate: `0.036`
- fp_decided_rate: `0.0`
- fn_decided_rate: `0.06923076923076923`
- fp_upper95: `0.003826898586390522`
- fn_upper95: `0.0494359438638175`
- fp_decided_upper95: `0.007333514558599393`
- fn_decided_upper95: `0.09435651618873045`
- constraint_met: `True`

Repro command

```
scripts/stage1_utility_tune.py --track fever --in_path /mnt/c/Users/nguye/Downloads/My projject/the-rag-auditor/data/calibration/fever_stage1_dev_train.parquet --logit_col logit_platt --y_col y --n 1000 --tau_source joint_grid --tau_grid_steps 60 --threshold_steps 60 --constraint_ci wilson --out_md reports/stage1_utility_tuning_fever.md --out_yaml configs/thresholds_stage1_product_fever.yaml
```
