# Stage1 Utility Tuning (fever)

Config

- in_path: `/mnt/c/Users/nguye/Downloads/My projject/the-rag-auditor/data/calibration/fever_stage1_dev_train.parquet`
- n_raw: `5715`
- n_used: `5715`
- seed: `14`
- logit_col: `logit_platt`
- y_col: `y`
- tau_source: `joint_grid`
- tau_grid_min: `0.2`
- tau_grid_max: `2.0`
- tau_grid_steps: `80`
- max_fp_accept_rate: `0.05`
- max_fn_reject_rate: `0.05`
- max_fp_decided_upper95: `0.1`
- max_fn_decided_upper95: `0.1`
- lambda_fp: `10.0`
- lambda_fn: `10.0`
- lambda_unc: `1.0`
- constraint_ci: `wilson`
- min_coverage: `0.0`
- constraint_scope: `both`
- enforce_decided_ci: `False`

Baseline thresholds

- tau: `0.9957177012600404`
- t_lower: `0.0721672686678491`
- t_upper: `1.0`

| metric | value |
|---|---|
| accept_rate | 0.0000 |
| reject_rate | 0.1081 |
| uncertain_rate | 0.8919 |
| fp_accept_rate | 0.0000 |
| fn_reject_rate | 0.0052 |
| ok_rate | 0.9948 |
| coverage | 0.1081 |
| accuracy_on_decided | 0.9515 |

- feasible_configs: `46821`

Top configs by utility

| tau | t_lower | t_upper | accept_rate | reject_rate | uncertain_rate | fp_accept_rate | fn_reject_rate | fp_decided | fn_decided | ok_rate | coverage | accuracy_on_decided | utility | label |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 1.3848 | 0.2381 | 0.3108 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.3233 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.3358 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.3484 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.3609 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.3734 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.3859 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.3985 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.4110 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.4235 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.4361 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.4486 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.4611 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.4737 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.4862 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.4987 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.5113 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.5238 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.5363 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |
| 1.3848 | 0.2381 | 0.5489 | 0.0000 | 0.9358 | 0.0642 | 0.0000 | 0.0878 | 0.0000 | 0.0939 | 0.9122 | 0.9358 | 0.9061 | -0.0068 | grid |

Pareto summary

| tau | t_lower | t_upper | fp_accept_rate | fn_reject_rate | uncertain_rate | ok_rate | utility |
|---|---|---|---|---|---|---|---|
| 0.9975 | 0.1128 | 0.2481 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.2606 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.2732 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.2857 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.2982 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.3108 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.3233 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.3358 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.3484 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.3609 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.3734 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.3859 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.3985 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.4110 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.4235 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.4361 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.4486 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.4611 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.4737 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |
| 0.9975 | 0.1128 | 0.4862 | 0.0000 | 0.0420 | 0.4275 | 0.9580 | -0.2749 |

Selected config

- tau: `0.9974683544303797`
- t_lower: `0.11278481012658227`
- t_upper: `0.24810126582278483`
- utility: `-0.2748906386701662`
- fp_accept_rate: `0.0`
- fn_reject_rate: `0.04199475065616798`
- fp_decided_rate: `0.0`
- fn_decided_rate: `0.07334963325183375`
- fp_upper95: `0.0006717444315995742`
- fn_upper95: `0.04751007432641215`
- fp_decided_upper95: `0.0011727062749309978`
- fn_decided_upper95: `0.0827919234807842`
- constraint_met: `True`

Repro command

```
scripts/stage1_utility_tune.py --track fever --in_path /mnt/c/Users/nguye/Downloads/My projject/the-rag-auditor/data/calibration/fever_stage1_dev_train.parquet --logit_col logit_platt --y_col y --seed 14 --tau_source joint_grid --tau_grid_steps 80 --threshold_steps 80 --constraint_ci wilson --out_md reports/stage1_utility_tuning_fever.md --out_yaml configs/thresholds_stage1_product_fever.yaml
```
