# Stage1 Utility Tuning (scifact)

Config

- in_path: `/mnt/c/Users/nguye/Downloads/My projject/the-rag-auditor/data/calibration/scifact_stage1_dev_train.parquet`
- n_raw: `776`
- n_used: `776`
- seed: `14`
- logit_col: `raw_max_top3`
- y_col: `y`
- tau_source: `joint_grid`
- tau_grid_min: `0.2`
- tau_grid_max: `2.0`
- tau_grid_steps: `80`
- max_fp_accept_rate: `0.05`
- max_fn_reject_rate: `0.05`
- max_fp_decided_upper95: `0.1`
- max_fn_decided_upper95: `0.1`
- lambda_fp: `10.0`
- lambda_fn: `10.0`
- lambda_unc: `1.0`
- constraint_ci: `wilson`
- min_coverage: `0.0`
- constraint_scope: `both`
- enforce_decided_ci: `False`

Baseline thresholds

- tau: `0.609483051351548`
- t_lower: `0.7792245061204353`
- t_upper: `0.8008901176300922`

| metric | value |
|---|---|
| accept_rate | 0.4536 |
| reject_rate | 0.0619 |
| uncertain_rate | 0.4845 |
| fp_accept_rate | 0.0425 |
| fn_reject_rate | 0.0322 |
| ok_rate | 0.9253 |
| coverage | 0.5155 |
| accuracy_on_decided | 0.8550 |

- feasible_configs: `91114`

Top configs by utility

| tau | t_lower | t_upper | accept_rate | reject_rate | uncertain_rate | fp_accept_rate | fn_reject_rate | fp_decided | fn_decided | ok_rate | coverage | accuracy_on_decided | utility | label |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 0.5646 | 0.0000 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.0125 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.0251 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.0376 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.0501 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.0627 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.0752 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.0877 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.1003 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.1128 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.1253 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.1378 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.1504 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.1629 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.1754 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.1880 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.2005 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.2130 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.2256 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |
| 0.5646 | 0.2381 | 0.8120 | 0.6456 | 0.0000 | 0.3544 | 0.0799 | 0.0000 | 0.1238 | 0.0000 | 0.9201 | 0.6456 | 0.8762 | -0.5077 | grid |

Pareto summary

| tau | t_lower | t_upper | fp_accept_rate | fn_reject_rate | uncertain_rate | ok_rate | utility |
|---|---|---|---|---|---|---|---|
| 0.7468 | 0.0000 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.0125 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.0251 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.0376 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.0501 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.0627 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.0752 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.0877 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.1003 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.1128 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.1253 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.1378 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.1504 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.1629 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.1754 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.1880 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.2005 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.2130 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.2256 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |
| 0.7468 | 0.2381 | 0.7619 | 0.0168 | 0.0000 | 0.7126 | 0.9832 | -0.5928 |

Selected config

- tau: `0.7468354430379747`
- t_lower: `0.0`
- t_upper: `0.7618987341772152`
- utility: `-0.5927835051546392`
- fp_accept_rate: `0.01675257731958763`
- fn_reject_rate: `0.0`
- fp_decided_rate: `0.05829596412556054`
- fn_decided_rate: `0.0`
- fp_upper95: `0.028450294131171547`
- fn_upper95: `0.00492612858816457`
- fp_decided_upper95: `0.09717142751566747`
- fn_decided_upper95: `0.01693516533122672`
- constraint_met: `True`

Repro command

```
scripts/stage1_utility_tune.py --track scifact --in_path /mnt/c/Users/nguye/Downloads/My projject/the-rag-auditor/data/calibration/scifact_stage1_dev_train.parquet --logit_col raw_max_top3 --y_col y --seed 14 --tau_source joint_grid --tau_grid_steps 80 --threshold_steps 80 --constraint_ci wilson --out_md reports/stage1_utility_tuning_scifact.md --out_yaml configs/thresholds_stage1_product_scifact.yaml
```
