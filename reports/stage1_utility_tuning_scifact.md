# Stage1 Utility Tuning (scifact)

Config

- in_path: `/mnt/c/Users/nguye/Downloads/My projject/the-rag-auditor/data/calibration/scifact_stage1_dev_train.parquet`
- n_raw: `776`
- n_used: `200`
- seed: `14`
- logit_col: `raw_max_top3`
- y_col: `y`
- tau_source: `config`
- tau_grid_min: `0.2`
- tau_grid_max: `2.0`
- tau_grid_steps: `50`
- max_fp_accept_rate: `0.05`
- max_fn_reject_rate: `0.05`
- lambda_fp: `10.0`
- lambda_fn: `10.0`
- lambda_unc: `1.0`

Baseline thresholds

- tau: `0.609483051351548`
- t_lower: `0.7792245061204353`
- t_upper: `0.8008901176300922`

| metric | value |
|---|---|
| accept_rate | 0.4450 |
| reject_rate | 0.0800 |
| uncertain_rate | 0.4750 |
| fp_accept_rate | 0.0300 |
| fn_reject_rate | 0.0250 |
| ok_rate | 0.9450 |
| coverage | 0.5250 |
| accuracy_on_decided | 0.8952 |

- feasible_configs: `391`

Top configs by utility

| tau | t_lower | t_upper | accept_rate | reject_rate | uncertain_rate | fp_accept_rate | fn_reject_rate | ok_rate | coverage | accuracy_on_decided | utility | label |
|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 0.6095 | 0.7792 | 0.8009 | 0.4450 | 0.0800 | 0.4750 | 0.0300 | 0.0250 | 0.9450 | 0.5250 | 0.8952 | -0.5000 | baseline_candidate |
| 0.6095 | 0.0000 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.0202 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.0404 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.0606 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.0808 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.1010 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.1212 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.1414 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.1616 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.1818 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.2020 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.2222 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.2424 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.2627 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.2829 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.3031 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.3233 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.3435 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |
| 0.6095 | 0.3637 | 0.7980 | 0.5450 | 0.0000 | 0.4550 | 0.0600 | 0.0000 | 0.9400 | 0.5450 | 0.8899 | -0.5100 | grid |

Pareto summary

| tau | t_lower | t_upper | fp_accept_rate | fn_reject_rate | uncertain_rate | ok_rate | utility |
|---|---|---|---|---|---|---|---|
| 0.6095 | 0.7792 | 0.8009 | 0.0300 | 0.0250 | 0.4750 | 0.9450 | -0.5000 |
| 0.6095 | 0.0000 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.0202 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.0404 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.0606 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.0808 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.1010 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.1212 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.1414 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.1616 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.1818 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.2020 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.2222 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.2424 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.2627 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.2829 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.3031 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.3233 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.3435 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |
| 0.6095 | 0.3637 | 0.8182 | 0.0000 | 0.0000 | 0.9900 | 1.0000 | -0.9800 |

Selected config

- tau: `0.609483051351548`
- t_lower: `0.7792245061204353`
- t_upper: `0.8008901176300922`
- utility: `-0.49999999999999994`
- feasible: `True`

Repro command

```
scripts/stage1_utility_tune.py --track scifact --in_path /mnt/c/Users/nguye/Downloads/My projject/the-rag-auditor/data/calibration/scifact_stage1_dev_train.parquet --logit_col raw_max_top3 --y_col y --n 200 --out_md reports/stage1_utility_tuning_scifact.md --out_yaml configs/thresholds_stage1_product_scifact.yaml
```
